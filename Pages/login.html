<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Login Form | Novatech</title>
    <link rel="stylesheet" href="/Css/loguin.css">
    <link rel="icon" href="/Img/Logo.webp">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
    <link rel="stylesheet" href="/Css/root.css">
    <script src="/Js/include.js"></script>
    <script src="/Js/script.js" defer></script>
</head>

<body>
    <div class="container">
        <div class="form-container">
            <div class="form-blob">
                <img src="/Img/login/blob.svg" alt="blob" class="blob-img blob--img1">
                <img src="/Img/login/blob.svg" alt="blob" class="blob-img blob--img2">
                <img src="/Img/login/blob.svg" alt="blob" class="blob-img blob--img3">
            </div>
            <div class="form-header">
                <button type="button" onclick="window.history.back()">
                    < Volver</button>
                        <h1>¡Bienvenido!</h1>
            </div>
            <!-- LOGIN -->
            <form id="loginForm" class="form-box active">
                <div class="input-group">
                    <input type="text" id="User" class="input-field" placeholder="" required>
                    <label for="email" class="floating-label">Username</label>
                </div>
                <div class="input-group">
                    <input type="password" id="password" class="input-field" placeholder="" required>
                    <label for="password" class="floating-label">Contraseña</label>
                    <div class="eye-icon" onclick="togglePassword()">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
                            stroke="currentColor" stroke-width="1.25" stroke-linecap="round" stroke-linejoin="round"
                            class="lucide lucide-eye-icon lucide-eye">
                            <path
                                d="M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0" />
                            <circle cx="12" cy="12" r="3" />
                        </svg>
                    </div>
                </div>
                <div class="input-group checkbox-group">
                    <div class="form-col remenber-me">
                        <input type="checkbox" id="remenber-me-checkbox" class="checkbox-field">
                        <label for="remenber-me-checkbox">Recuerdame</label>
                    </div>
                    <div class="form-col">
                        <a href="#" class="form-link">¿Olvidaste la contraseña?</a>
                    </div>
                </div>
                <button type="submit" class="form-btn form-btn--submit">Iniciar sesión</button>
            </form>
        </div>
    </div>

    <script src="/Js/login.js"></script>
    <script>
        document.getElementById("loginForm").addEventListener("submit", async (e) => {
            e.preventDefault();

            const username = document.getElementById("User").value.trim();
            const password = document.getElementById("password").value.trim();

            // Validación básica
            if (!username || !password) {
                alert("Falta username o contraseña");
                return;
            }

            try {
                const res = await fetch("https://fakestoreapi.com/auth/login", {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify({
                        username: username,
                        password: password
                    })
                });

                // Si no responde ok
                if (!res.ok) {
                    alert("Usuario o contraseña incorrectos");
                    return;
                }

                const data = await res.json();

                // Guarda el token en localStorage
                localStorage.setItem("token", data.token);

                alert("Login exitoso!");

                // Aquí redirigimos a la pagina de tienda
                window.location.href = "/Pages/tienda.html";

            } catch (error) {
                console.error("Error en el login:", error);
                alert("Hubo un error, intenta luego");
            }
        });
    </script>


</body>

</html>